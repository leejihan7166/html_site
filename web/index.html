<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TRPG ì„¤ì •ì§‘ + ìŠ¤íƒ¯ ë¶„ë°° & íŠ¹ì„± ì‹œìŠ¤í…œ</title>
  <style>
    body {
      margin: 0;
      font-family: 'Arial', sans-serif;
      background: #121212;
      color: #eee;
      display: flex;
      height: 100vh;
      overflow: hidden;
      position: relative;
    }
    .left-panel {
      width: 40%;
      background: #1f1f1f;
      padding: 30px;
      overflow-y: auto;
      box-sizing: border-box;
      border-right: 2px solid #333;
      transition: transform 0.3s ease;
    }
    .left-panel.closed {
      transform: translateX(-100%);
    }
    .toggle-menu {
      position: absolute;
      top: 10px;
      left: 10px;
      background: #2c2c2c;
      border: 1px solid #444;
      color: #eee;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      z-index: 9999;
    }
    .right-panel {
      flex-grow: 1;
      background: #181818;
      padding: 30px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      width: 100%;
      overflow: hidden;
      position: relative;
    }
    #content-wrapper {
      flex: 1;
      overflow-y: auto;
      padding-right: 10px;
    }
    .right-panel input, select, .left-panel select {
      background: #292929;
      color: #fff;
      border: 1px solid #555;
      padding: 8px;
      border-radius: 5px;
      margin-bottom: 15px;
      width: 100%;
      box-sizing: border-box;
    }
    .stat {
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .stat strong {
      width: 80px;
      flex-shrink: 0;
    }
    .stat button {
      background: #444;
      border: none;
      color: #fff;
      width: 28px;
      height: 28px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      flex-shrink: 0;
    }
    .stat button:disabled {
      background: #222;
      cursor: not-allowed;
    }
    .submit-btn {
      margin-top: 20px;
      padding: 10px;
      font-size: 16px;
      background: #00bfa5;
      color: #121212;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      align-self: flex-start;
    }
    .final-stats {
      white-space: pre-wrap;
      background: #292929;
      padding: 15px;
      border-radius: 8px;
      margin-top: 10px;
      height: 250px;
      overflow-y: auto;
      font-family: monospace;
      font-size: 14px;
      position: sticky;
      bottom: 0;
      z-index: 10;
      box-shadow: 0 -4px 10px rgba(0,0,0,0.5);
    }
    .image-preview {
      width: 100%;
      max-height: 180px;
      object-fit: cover;
      margin-bottom: 10px;
      border-radius: 6px;
    }

    /* íŠ¹ì„± í•­ëª© ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ - ì˜¤ë¥¸ìª½ ì°½ ë‚´ ìì—°ìŠ¤ëŸ¬ìš´ ë°°ì¹˜ */
    #traits-container {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 0;
      margin-bottom: 20px;
    }
    .trait {
      background: #202020;
      border-radius: 8px;
      padding: 6px 10px;
      display: flex;
      align-items: center;
      cursor: pointer;
      user-select: none;
      width: calc(50% - 6px);
      box-sizing: border-box;
      gap: 10px;
      transition: background-color 0.3s;
    }
    .trait:hover {
      background-color: #2a2a2a;
    }
    .trait img.image-preview {
      width: 32px;
      height: 32px;
      object-fit: contain;
      flex-shrink: 0;
      border-radius: 4px;
    }
    .trait span {
      flex-grow: 1;
      color: #eee;
      font-size: 14px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .trait input[type="checkbox"] {
      appearance: none;
      -webkit-appearance: none;
      width: 22px;
      height: 22px;
      border: 2.5px solid #00bfa5;
      border-radius: 5px;
      background-color: transparent;
      cursor: pointer;
      position: relative;
      flex-shrink: 0;
      transition: background-color 0.3s, border-color 0.3s;
    }
    .trait input[type="checkbox"]:hover {
      border-color: #00fff0;
    }
    .trait input[type="checkbox"]:checked {
      background-color: #00bfa5;
      border-color: #00bfa5;
    }
    .trait input[type="checkbox"]:checked::after {
      content: "";
      position: absolute;
      top: 3px;
      left: 7px;
      width: 5px;
      height: 11px;
      border: solid #121212;
      border-width: 0 3px 3px 0;
      transform: rotate(45deg);
    }

    /* ë¯¿ëŠ” ì‹  ì„ íƒíŒë„¬ ìŠ¤íƒ€ì¼ */
    #faith-container {
      display: flex;
      flex-wrap: wrap;
      max-width: 640px;
      gap: 15px;
      margin-bottom: 15px;
    }
    .faith-option {
      background: #292929;
      border: 2px solid transparent;
      border-radius: 10px;
      width: 120px;
      cursor: pointer;
      text-align: center;
      padding: 10px;
      transition: border-color 0.3s;
      user-select: none;
      color: #eee;
      font-size: 14px;
    }
    .faith-option img {
      width: 80px;
      height: 80px;
      object-fit: contain;
      margin-bottom: 8px;
      border-radius: 6px;
      pointer-events: none;
      user-select: none;
    }
    .faith-option.selected {
      border-color: #00bfa5;
      background-color: #1a7f73;
      color: #121212;
      font-weight: bold;
    }

    .dice-container {
      position: absolute;
      bottom: 10px;
      right: 10px;
      background: #2b2b2b;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #444;
      font-size: 14px;
      text-align: center;
      user-select: none;
    }
    .dice-container button {
      margin-top: 5px;
      padding: 5px 10px;
      background: #444;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <div class="toggle-menu" onclick="toggleLeftPanel()">ğŸ“‚ ë©”ë‰´</div>

  <div class="left-panel" id="left-panel">
    <h1>ğŸŒ ì„¸ê³„ê´€ ì„ íƒ</h1>
    <select id="world-select">
      <option value="ë²¨ë£¨ì•„ ëŒ€ë¥™">ë²¨ë£¨ì•„ ëŒ€ë¥™</option>
      <option value="ì•„ë¥´ì¼€ë…¸ìŠ¤ ì œêµ­">ì•„ë¥´ì¼€ë…¸ìŠ¤ ì œêµ­</option>
      <option value="ë¼ê·¸ë‚˜ë¡œí¬ í‰ì›">ë¼ê·¸ë‚˜ë¡œí¬ í‰ì›</option>
    </select>

    <img id="world-image" class="image-preview" src="" alt="ì„¸ê³„ê´€ ì´ë¯¸ì§€" />

    <h2>ğŸ“œ ì„¸ê³„ê´€ ì„¤ëª…</h2>
    <div id="world-description"></div>

    <h2>ğŸ›¡ï¸ ì§ì—… ì„ íƒ</h2>
    <select id="job-select">
      <option value="ì „ì‚¬">ì „ì‚¬</option>
      <option value="ë§ˆë²•ì‚¬">ë§ˆë²•ì‚¬</option>
      <option value="ë„ì ">ë„ì </option>
      <option value="ì‚¬ì œ">ì‚¬ì œ</option>
    </select>

    <h2>ğŸš» ì„±ë³„ ì„ íƒ</h2>
    <select id="gender-select">
      <option value="ë‚¨ì„±">ë‚¨ì„±</option>
      <option value="ì—¬ì„±">ì—¬ì„±</option>
      <option value="ê¸°íƒ€">ê¸°íƒ€</option>
    </select>

    <h2>ğŸ¯ ë‚œì´ë„ ì„ íƒ</h2>
    <select id="difficulty-select">
      <option value="ì‰¬ì›€">ì‰¬ì›€</option>
      <option value="ë³´í†µ" selected>ë³´í†µ</option>
      <option value="ì–´ë ¤ì›€">ì–´ë ¤ì›€</option>
    </select>
  </div>

  <div class="right-panel">
    <h1>ğŸ§™ ìºë¦­í„° ìƒì„±</h1>

    <div id="content-wrapper">
      <input type="text" id="char-name" placeholder="ìºë¦­í„° ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" />

      <div id="stats-container"></div>
      <div id="remaining-points" style="margin-bottom: 20px; font-weight: bold;"></div>

      <h2>íŠ¹ì„± ì„ íƒ</h2>
      <div id="traits-container"></div>

      <h2>ë¯¿ëŠ” ì‹  (ì¢…êµ) ì„ íƒ</h2>
      <div id="faith-container"></div>

      <button class="submit-btn" id="submit-btn">ê²°ê³¼ í™•ì¸</button>

      <div class="final-stats" id="final-stats"></div>
    </div>
  </div>

  <div class="dice-container">
    ğŸ² ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°<br />
    <button onclick="rollDice()">1d6</button>
    <div id="dice-result"></div>
  </div>

  <script>
    let totalPoints = 20;

    const difficultyLevels = {
      'ì‰¬ì›€': 25,
      'ë³´í†µ': 20,
      'ì–´ë ¤ì›€': 15
    };

    const worldDescriptions = {
      'ë²¨ë£¨ì•„ ëŒ€ë¥™': 'ì „ìŸê³¼ ë§ˆë ¥ì´ ê³µì¡´í•˜ëŠ” ëŒ€ë¥™.',
      'ì•„ë¥´ì¼€ë…¸ìŠ¤ ì œêµ­': 'ê¸°ê³„ì™€ ë§ˆë²•ì´ ì¶©ëŒí•˜ëŠ” ê°•ë ¥í•œ ì œêµ­.',
      'ë¼ê·¸ë‚˜ë¡œí¬ í‰ì›': 'ëì—†ëŠ” ì „ìŸì˜ ì €ì£¼ë°›ì€ ë“¤íŒ.'
    };

    const worldImages = {
      'ë²¨ë£¨ì•„ ëŒ€ë¥™': 'https://example.com/world1.jpg',
      'ì•„ë¥´ì¼€ë…¸ìŠ¤ ì œêµ­': 'https://example.com/world2.jpg',
      'ë¼ê·¸ë‚˜ë¡œí¬ í‰ì›': 'https://example.com/world3.jpg'
    };

    const stats = [
      { key: 'STR', name: 'í˜ (STR)', value: 5, min: 1, max: 10 },
      { key: 'DEX', name: 'ë¯¼ì²© (DEX)', value: 5, min: 1, max: 10 },
      { key: 'INT', name: 'ì§€ëŠ¥ (INT)', value: 5, min: 1, max: 10 },
      { key: 'CON', name: 'ì²´ë ¥ (CON)', value: 5, min: 1, max: 10 }
    ];

    const traits = [
      { id: 'strong', name: 'ê°•ì¸í•¨ (í¬ì¸íŠ¸ -2)', cost: -2, image: 'power.png' },
      { id: 'quick', name: 'ë¯¼ì²©í•œ ì†ë†€ë¦¼ (í¬ì¸íŠ¸ -2)', cost: -2, image: 'https://example.com/trait_quick.jpg' },
      { id: 'fragile', name: 'í—ˆì•½í•¨ (í¬ì¸íŠ¸ +2)', cost: 2, image: 'https://example.com/trait_fragile.jpg' },
      { id: 'clumsy', name: 'ì„œíˆ¬ë¦„ (í¬ì¸íŠ¸ +2)', cost: 2, image: 'https://example.com/trait_clumsy.jpg' }
    ];

    const faiths = [
      { id: 'none', name: 'ì—†ìŒ', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0c/Black_flag.svg/120px-Black_flag.svg.png' },
      { id: 'sun', name: 'íƒœì–‘ì‹ ', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/7/75/Sun_symbol.svg/120px-Sun_symbol.svg.png' },
      { id: 'earth', name: 'ëŒ€ì§€ì˜ ì—¬ì‹ ', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/58/Earth_icon.svg/120px-Earth_icon.svg.png' },
      { id: 'wind', name: 'ë°”ëŒì˜ ì‹ ', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/f/f2/Weather-wind.svg/120px-Weather-wind.svg.png' },
      { id: 'dark', name: 'ì–´ë‘ ì˜ ì‹ ', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/31/Darkness_icon.svg/120px-Darkness_icon.svg.png' },
      { id: 'wisdom', name: 'ì§€í˜œì˜ ì‹ ', image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/10/Light_bulb_icon.svg/120px-Light_bulb_icon.svg.png' }
    ];

    const selectedTraits = new Set();
    let selectedFaith = 'none';

    const statsContainer = document.getElementById('stats-container');
    const remainingEl = document.getElementById('remaining-points');
    const traitsContainer = document.getElementById('traits-container');
    const submitBtn = document.getElementById('submit-btn');
    const finalStatsEl = document.getElementById('final-stats');
    const charNameEl = document.getElementById('char-name');
    const worldSelect = document.getElementById('world-select');
    const jobSelect = document.getElementById('job-select');
    const genderSelect = document.getElementById('gender-select');
    const difficultySelect = document.getElementById('difficulty-select');
    const worldDescription = document.getElementById('world-description');
    const worldImage = document.getElementById('world-image');
    const diceResult = document.getElementById('dice-result');
    const faithContainer = document.getElementById('faith-container');

    function toggleLeftPanel() {
      document.getElementById('left-panel').classList.toggle('closed');
    }

    function updateTotalPoints() {
      totalPoints = difficultyLevels[difficultySelect.value];
      renderStats();
    }

    difficultySelect.onchange = () => {
      updateTotalPoints();
      selectedTraits.clear();
      renderTraits();
      finalStatsEl.textContent = '';
    };

    worldSelect.onchange = () => {
      worldDescription.textContent = worldDescriptions[worldSelect.value];
      worldImage.src = worldImages[worldSelect.value];
    };
    worldSelect.onchange();

    function renderStats() {
      statsContainer.innerHTML = '';
      const used = stats.reduce((sum, s) => sum + s.value, 0);
      const remaining = totalPoints - used;

      stats.forEach((stat, idx) => {
        const div = document.createElement('div');
        div.className = 'stat';
        div.innerHTML = `
          <strong>${stat.name}</strong>
          <button onclick="changeStat(${idx}, -1)" ${stat.value <= stat.min ? 'disabled' : ''}>-</button>
          <span>${stat.value}</span>
          <button onclick="changeStat(${idx}, 1)" ${ (stat.value >= stat.max || remaining <= 0) ? 'disabled' : ''}>+</button>
        `;
        statsContainer.appendChild(div);
      });

      updateRemaining();
    }

    function changeStat(idx, delta) {
      const used = stats.reduce((sum, s) => sum + s.value, 0);
      if (delta > 0 && used >= totalPoints) return;
      if (stats[idx].value + delta < stats[idx].min) return;
      if (stats[idx].value + delta > stats[idx].max) return;
      stats[idx].value += delta;
      renderStats();
    }

    function updateRemaining() {
      const used = stats.reduce((sum, s) => sum + s.value, 0);
      remainingEl.textContent = `ë‚¨ì€ í¬ì¸íŠ¸: ${totalPoints - used}`;
    }

    function renderTraits() {
      traitsContainer.innerHTML = '';
      traits.forEach(trait => {
        const label = document.createElement('label');
        label.className = 'trait';

        const img = document.createElement('img');
        img.src = trait.image;
        img.alt = trait.name;
        img.className = 'image-preview';

        const span = document.createElement('span');
        span.textContent = trait.name;

        const input = document.createElement('input');
        input.type = 'checkbox';

        input.checked = selectedTraits.has(trait.id);

        input.onchange = () => {
          const used = stats.reduce((sum, s) => sum + s.value, 0);
          if (input.checked) {
            if (trait.cost < 0 && totalPoints + trait.cost < used) {
              alert('í¬ì¸íŠ¸ê°€ ë¶€ì¡±í•˜ì—¬ ì´ íŠ¹ì„±ì„ ì„ íƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
              input.checked = false;
              return;
            }
            selectedTraits.add(trait.id);
            totalPoints += trait.cost;
          } else {
            selectedTraits.delete(trait.id);
            totalPoints -= trait.cost;
          }
          renderStats();
          finalStatsEl.textContent = '';
        };

        label.appendChild(img);
        label.appendChild(span);
        label.appendChild(input);

        traitsContainer.appendChild(label);
      });
    }

    function renderFaithOptions() {
      faithContainer.innerHTML = '';
      faiths.forEach(faith => {
        const div = document.createElement('div');
        div.className = 'faith-option';
        if (faith.id === selectedFaith) div.classList.add('selected');

        div.innerHTML = `
          <img src="${faith.image}" alt="${faith.name}" />
          <div>${faith.name}</div>
        `;

        div.onclick = () => {
          selectedFaith = faith.id;
          renderFaithOptions();
          finalStatsEl.textContent = '';
        };

        faithContainer.appendChild(div);
      });
    }

    function rollDice() {
      const roll = Math.floor(Math.random() * 6) + 1;
      diceResult.textContent = `ê²°ê³¼: ${roll}`;
    }

    submitBtn.onclick = () => {
      const name = charNameEl.value.trim();
      if (!name) {
        alert('ìºë¦­í„° ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”!');
        return;
      }
      let result = `=== ìºë¦­í„° ì •ë³´ ===\n`;
      result += `ì´ë¦„: ${name}\n`;
      result += `ì„¸ê³„ê´€: ${worldSelect.value}\n`;
      result += `ì§ì—…: ${jobSelect.value}\n`;
      result += `ì„±ë³„: ${genderSelect.value}\n`;
      result += `ë‚œì´ë„: ${difficultySelect.value}\n\n`;

      result += `--- ìŠ¤íƒ¯ ---\n`;
      stats.forEach(s => {
        result += `${s.name}: ${s.value}\n`;
      });

      result += `\n--- íŠ¹ì„± ---\n`;
      if (selectedTraits.size === 0) {
        result += "ì—†ìŒ\n";
      } else {
        traits.forEach(t => {
          if (selectedTraits.has(t.id)) {
            result += `${t.name}\n`;
          }
        });
      }

      const faithName = faiths.find(f => f.id === selectedFaith)?.name || 'ì—†ìŒ';
      result += `\n--- ë¯¿ëŠ” ì‹  ---\n${faithName}\n`;

      finalStatsEl.textContent = result;
    };
    // ì´ˆê¸°í™” ë° ë Œë”ë§
    updateTotalPoints();
    renderTraits();
    renderFaithOptions();
  </script>
</body>
</html>
